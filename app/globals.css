@tailwind base;
@tailwind components;
@tailwind utilities;

/* Base font size is controlled by the scale parameter */
html {
  font-size: 16px; /* Default font size, will be overridden by scale parameter if present */
}

:root {
  --font-jersey: 'Jersey 10', monospace;
  --color-bg-main: #ffffff;
  --color-bg-overlay: #f8f9fa;
  --color-bg-card: #ffffff;
  --color-text-main: #1a202c;
  --color-text-muted: #4a5568;
  --color-accent: #d4a574;
  --color-accent-dark: #a67c52;
  --color-border: #e2e8f0;
  --color-beige-light: #f5f5dc;
  --color-beige-dark: #8b7355;
  
  /* CSS variables for Tailwind typography plugin */
  --foreground-rgb: 26, 32, 44;
  --background-rgb: 255, 255, 255;
  --foreground-rgb-dark: 229, 231, 235;
  --background-rgb-dark: 26, 32, 44;
  --code-bg-dark: 45, 45, 45;
  --code-block-bg-dark: 30, 30, 30;
  --border-color-dark: 75, 75, 75;
}

/* Dark mode variables */
.dark {
  --color-bg-main: #181c20;
  --color-bg-overlay: #23272b;
  --color-bg-card: #23272b;
  --color-text-main: #e5e7eb;
  --color-text-muted: #b0b4ba;
  --color-border: #2d3238;
}

/* Headings use Inter by default */
h1, .heading-font, .font-heading {
  font-family: 'Inter', sans-serif;
  letter-spacing: 0.01em;
  font-weight: 400;
}
h2, h3, h4 {
  font-family: 'Inter', sans-serif;
  font-weight: 400;
}

/* All paragraphs and text elements use Inter by default */
p, span, div, a, button, input, textarea, label {
  font-family: 'Inter', sans-serif;
  font-weight: 400;
}

/* Jersey 10 font for special headings */
.font-jersey {
  font-family: var(--font-jersey), monospace;
  letter-spacing: 0.02em;
  font-weight: 400;
}

/* Inter font for body text (explicit override) */
.font-inter {
  font-family: 'Inter', sans-serif !important;
  font-weight: 400;
}

@media (prefers-color-scheme: dark) {
  :root {
    --foreground-rgb: 255, 255, 255;
    --background-rgb: 30, 30, 30;
  }
}

/* Apply light/dark mode to body */
body {
  background: var(--color-bg-main);
  color: var(--color-text-main);
  font-family: 'Inter', sans-serif;
  font-weight: 400;
  transition: background-color 0.3s ease, color 0.3s ease;
}

.bg-main {
  background: var(--color-bg-main) !important;
}
.bg-overlay {
  background: var(--color-bg-overlay) !important;
}
.bg-card {
  background: var(--color-bg-card) !important;
}
.text-main {
  color: var(--color-text-main) !important;
}
.text-muted {
  color: var(--color-text-muted) !important;
}

/* Ensure high contrast text in both themes */
.text-high-contrast {
  color: var(--color-text-main) !important;
  font-weight: 500;
}

/* Light theme specific text colors */
:root .text-light-theme {
  color: #1a202c !important;
}

/* Dark theme specific text colors */
.dark .text-light-theme {
  color: #e5e7eb !important;
}
.border-main {
  border-color: var(--color-border) !important;
}

/* Beige colors */
.bg-beige-light {
  background-color: var(--color-beige-light) !important;
}
.bg-beige {
  background-color: var(--color-accent) !important;
}
.bg-beige-dark {
  background-color: var(--color-accent-dark) !important;
}

/* Almond beige for astronomy page */
.bg-almond-beige {
  background-color: #C8AD7F !important;
}

.dark .bg-almond-beige {
  background-color: #A67B5B !important;
}
.text-beige-dark {
  color: var(--color-beige-dark) !important;
}
.border-beige-dark {
  border-color: var(--color-beige-dark) !important;
}

/* Dark mode overrides for common elements */
.dark .bg-white {
  background-color: rgb(var(--chat-message-bg-dark));
}

.dark .text-gray-700 {
  color: rgb(229, 231, 235);
}

.dark .text-gray-600 {
  color: rgb(209, 213, 219);
}

.dark .border-gray-300 {
  border-color: rgb(75, 75, 75);
}

.dark .border-gray-200 {
  border-color: rgb(75, 75, 75);
}

.dark .bg-blue-50 {
  background-color: rgb(30, 58, 138);
}

.dark .border-blue-100 {
  border-color: rgb(37, 99, 235);
}

/* Apply light mode to prose content */
.prose {
  color: var(--color-text-main);
}

/* Apply dark mode to prose content */
.dark .prose {
  color: var(--color-text-main);
}

/* Code block styling */
.prose pre {
  background-color: #f8f9fa;
  border: 1px solid #e5e7eb;
  border-radius: 0.375rem;
  padding: 1rem;
  overflow-x: auto;
  margin: 1rem 0;
  position: relative;
}

.prose code {
  background-color: #f1f1f1;
  padding: 0.2em 0.4em;
  border-radius: 0.25rem;
  font-size: 0.875em;
}

.prose pre code {
  padding: 0;
  white-space: pre !important;
  text-indent: 0;
  background-color: transparent;
}

/* Copy button styling */
.prose pre {
  position: relative;
  padding-right: 2.5rem;
}

.prose pre {
  position: relative;
}

/* Code block and copy button styling */
.prose pre {
  position: relative !important;
  overflow: visible !important;
}

/* Ensure the code block wrapper takes full width */
.code-block-wrapper {
  width: 100%;
  position: relative;
  overflow: visible;
}

/* Copy button styling - always visible */
.copy-button {
  transition: opacity 0.2s;
  z-index: 50;
}

/* New copy button styling */
.copy-code-button {
  opacity: 0;
  transition: opacity 0.2s;
}

pre:hover .copy-code-button {
  opacity: 1;
}

/* Dark mode code block styling */
.dark .prose pre {
  background-color: #1e1e1e;
  border-color: #2d2d2d;
  color: #e6e6e6;
}

.dark .prose code {
  background-color: #2d2d2d;
  color: #e6e6e6;
}

.dark .prose pre code {
  background-color: transparent;
  color: #e6e6e6;
  padding: 0;
}

/* Python code block specific styling */
.prose pre:has(code.language-python),
.prose pre:has(code.language-py) {
  background-color: #f8f8f8;
  border: 1px solid #ddd;
  color: #000000;
  padding: 1rem;
}

.prose pre:has(code.language-python) code,
.prose pre:has(code.language-py) code {
  color: #000000;
  background-color: transparent;
  padding: 0;
  white-space: pre;
  text-indent: 0;
}

.dark .prose pre:has(code.language-python),
.dark .prose pre:has(code.language-py) {
  background-color: #1a1a1a;
  border-color: #333;
  color: #f8f8f8;
  padding: 1rem;
}

.dark .prose pre:has(code.language-python) code,
.dark .prose pre:has(code.language-py) code {
  color: #f8f8f8;
  background-color: transparent;
  padding: 0;
  white-space: pre;
  text-indent: 0;
}

/* Basic syntax highlighting for light mode */
.hljs-keyword { color: #0000ff; }
.hljs-built_in { color: #0000ff; }
.hljs-type { color: #2b91af; }
.hljs-string { color: #a31515; }
.hljs-number { color: #09885a; }
.hljs-comment { color: #008000; }
.hljs-function { color: #795e26; }
.hljs-title { color: #795e26; }
.hljs-params { color: #000000; }
.hljs-literal { color: #0000ff; }

/* Inline code styling */
:not(pre) > code {
  background-color: rgba(0, 0, 0, 0.05);
  border-radius: 3px;
  font-family: monospace;
  padding: 0.2em 0.4em;
  font-weight: 600;
  color: #0550ae;
}

.dark :not(pre) > code {
  background-color: rgba(255, 255, 255, 0.1);
  color: #79c0ff;
}

/* Ensure inline code stays inline */
.inline-code {
  display: inline !important;
}

/* Remove backticks from inline code */
.prose code::before,
.prose code::after,
.prose :where(code):not(:where([class~="not-prose"] *))::before,
.prose :where(code):not(:where([class~="not-prose"] *))::after {
  content: none !important;
  display: none !important;
}

/* Let inline code wrap naturally */
:not(pre) > code {
  white-space: normal;
}

/* Syntax highlighting for dark mode */
.dark .hljs-keyword,
.dark .hljs-selector-tag,
.dark .hljs-title,
.dark .hljs-section,
.dark .hljs-doctag,
.dark .hljs-name,
.dark .hljs-strong {
  color: #ff7b72;
}

.dark .hljs-attr,
.dark .hljs-attribute,
.dark .hljs-variable,
.dark .hljs-template-variable,
.dark .hljs-type,
.dark .hljs-selector-class,
.dark .hljs-selector-attr,
.dark .hljs-selector-pseudo,
.dark .hljs-number {
  color: #79c0ff;
}

.dark .hljs-string,
.dark .hljs-regexp,
.dark .hljs-addition,
.dark .hljs-attribute,
.dark .hljs-meta-string {
  color: #a5d6ff;
}

.dark .hljs-comment,
.dark .hljs-quote {
  color: #8b949e;
}

.dark .hljs-built_in,
.dark .hljs-literal,
.dark .hljs-type,
.dark .hljs-params,
.dark .hljs-meta,
.dark .hljs-link {
  color: #ffa657;
}

.dark .hljs-function {
  color: #d2a8ff;
}

/* KaTeX Math Rendering */
.katex {
  font-size: 1.1em;
}

.katex-display {
  overflow-x: auto;
  overflow-y: hidden;
  padding: 0.5rem 0;
  margin: 1rem 0;
}

.dark .katex .katex-html {
  color: rgb(var(--foreground-rgb-dark));
}

/* Ensure line breaks in user messages are preserved */
.prose p {
  white-space: pre-line;
}

.bg-fadein {
  opacity: 0.5;
  animation: fadeInBackground 0.5s forwards;
}

@keyframes fadeInBackground {
  to {
    opacity: 1;
  }
}

/* Buttons and accent */
.btn-accent {
  background: var(--color-accent);
  color: #2d3238;
  border-radius: 0.5rem;
  font-weight: 600;
  transition: background 0.2s;
}
.btn-accent:hover {
  background: var(--color-accent-dark);
  color: #fff;
}

/* Card shadow for sobriety */
.card-shadow {
  box-shadow: 0 2px 16px 0 rgba(30, 41, 59, 0.12);
}

/* Overlay for darkening */
.sober-overlay {
  background: rgba(24, 28, 32, 0.7);
}

/* Page transitions */
.page-fade-in {
  opacity: 0;
  animation: pageFadeIn 0.8s ease-out forwards;
}

.page-fade-out {
  opacity: 1;
  animation: pageFadeOut 0.6s ease-in forwards;
}

@keyframes pageFadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes pageFadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

/* Smooth transitions for navigation */
.nav-transition {
  transition: all 0.3s ease-in-out;
}

/* Content fade in with delay */
.content-fade-in {
  opacity: 0;
  animation: contentFadeIn 1s ease-out 0.2s forwards;
}

@keyframes contentFadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Menu animations */
.menu-fade-in {
  animation: menuFadeIn 0.2s ease-out forwards;
}

@keyframes menuFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Enhanced text readability utilities */
.text-readable {
  color: var(--color-text-main) !important;
  font-weight: 400;
  line-height: 1.6;
}

.text-readable-strong {
  color: var(--color-text-main) !important;
  font-weight: 600;
  line-height: 1.5;
}

/* Ensure proper contrast for headings */
h1, h2, h3, h4, h5, h6 {
  color: var(--color-text-main) !important;
  font-weight: 500;
}

/* Ensure proper contrast for paragraphs and text */
p, span, div, a, button, input, textarea, label {
  color: var(--color-text-main) !important;
}

/* High contrast mode for accessibility */
@media (prefers-contrast: high) {
  :root {
    --color-text-main: #000000;
    --color-text-muted: #333333;
  }
  
  .dark {
    --color-text-main: #ffffff;
    --color-text-muted: #cccccc;
  }
}

/* Additional text contrast improvements */
.text-white {
  color: var(--color-text-main) !important;
}

.dark .text-white {
  color: #ffffff !important;
}

/* Ensure proper contrast for all text elements */
* {
  color: inherit;
}

/* Override any hardcoded text colors that might cause issues */
.text-gray-700,
.text-gray-600,
.text-gray-500,
.text-gray-400 {
  color: var(--color-text-main) !important;
}

.dark .text-gray-700,
.dark .text-gray-600,
.dark .text-gray-500,
.dark .text-gray-400 {
  color: var(--color-text-main) !important;
}

/* Ensure buttons and interactive elements have proper contrast */
button, a, input, textarea {
  color: var(--color-text-main) !important;
}

/* Override any remaining hardcoded colors */
.text-black {
  color: var(--color-text-main) !important;
}

.dark .text-black {
  color: #ffffff !important;
}

/* Additional overrides for common text colors */
.text-slate-900,
.text-slate-800,
.text-slate-700,
.text-slate-600,
.text-slate-500,
.text-slate-400 {
  color: var(--color-text-main) !important;
}

.dark .text-slate-900,
.dark .text-slate-800,
.dark .text-slate-700,
.dark .text-slate-600,
.dark .text-slate-500,
.dark .text-slate-400 {
  color: var(--color-text-main) !important;
}

/* Ensure all text elements inherit the proper color */
body * {
  color: inherit;
}

/* Force proper contrast for critical text elements */
h1, h2, h3, h4, h5, h6, p, span, div, a, button, input, textarea, label {
  color: var(--color-text-main) !important;
}

/* Ensure proper contrast in both themes */
:root {
  color-scheme: light;
}

.dark {
  color-scheme: dark;
}

/* Additional accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Final overrides for any remaining hardcoded colors */
.text-neutral-900,
.text-neutral-800,
.text-neutral-700,
.text-neutral-600,
.text-neutral-500,
.text-neutral-400,
.text-neutral-300,
.text-neutral-200,
.text-neutral-100 {
  color: var(--color-text-main) !important;
}

.dark .text-neutral-900,
.dark .text-neutral-800,
.dark .text-neutral-700,
.dark .text-neutral-600,
.dark .text-neutral-500,
.dark .text-neutral-400,
.dark .text-neutral-300,
.dark .text-neutral-200,
.dark .text-neutral-100 {
  color: var(--color-text-main) !important;
}

/* Ensure proper contrast for all text elements */
.text-current {
  color: var(--color-text-main) !important;
}

/* Override any remaining color utilities */
[class*="text-"] {
  color: var(--color-text-main) !important;
}

/* But allow specific colors to work */
.text-blue-400,
.text-blue-500,
.text-blue-600,
.text-green-400,
.text-green-500,
.text-yellow-400,
.text-yellow-500,
.text-red-400,
.text-red-500 {
  color: currentColor !important;
}

/* Ensure proper contrast for the deployed version */
@media (min-width: 1px) {
  body {
    color: var(--color-text-main) !important;
  }
  
  * {
    color: inherit;
  }
}